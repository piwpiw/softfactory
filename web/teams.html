<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teams - JARVIS</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-900 text-white">
    <nav class="bg-gray-800 border-b border-gray-700 px-6 py-4 flex justify-between items-center">
        <h1 class="text-2xl font-bold">Team Management</h1>
        <a href="index.html" class="text-gray-400 hover:text-white">â† í™ˆ</a>
    </nav>

    <main class="p-6 max-w-6xl mx-auto">
        <!-- Team Stats -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-8">
            <div class="bg-orange-600 p-4 rounded">
                <div class="text-sm">ì „ì²´ íŒ€</div>
                <div id="total-teams" class="text-3xl font-bold">-</div>
            </div>
            <div class="bg-blue-600 p-4 rounded">
                <div class="text-sm">íŒ€ì› ìˆ˜</div>
                <div id="total-members" class="text-3xl font-bold">-</div>
            </div>
            <div class="bg-green-600 p-4 rounded">
                <div class="text-sm">í™œìš©ë¥ </div>
                <div id="avg-util" class="text-3xl font-bold">-</div>
            </div>
            <div class="bg-purple-600 p-4 rounded">
                <div class="text-sm">ìƒíƒœ</div>
                <div id="team-status" class="text-3xl font-bold">-</div>
            </div>
        </div>

        <!-- Teams Grid -->
        <div id="teams-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
            <div class="bg-gray-800 p-4 rounded animate-pulse">ë¡œë”© ì¤‘...</div>
        </div>
    </main>

    <script>
        async function loadTeams() {
            try {
                const res = await fetch('/api/v1/teams');
                const data = await res.json();

                // Stats
                document.getElementById('total-teams').textContent = data.summary.total_teams;
                document.getElementById('total-members').textContent = data.summary.total_members;
                document.getElementById('avg-util').textContent = data.summary.avg_utilization;
                document.getElementById('team-status').textContent = data.summary.status;

                // Teams
                const html = data.teams.map(t => `
                    <div class="bg-gray-800 p-6 rounded-lg hover:bg-gray-700 transition cursor-pointer">
                        <h3 class="text-xl font-bold mb-2">${t.name}</h3>
                        <p class="text-sm text-gray-400 mb-3">${t.members}ëª… â€¢ ${t.utilization}% í™œìš©</p>
                        <div class="bg-gray-700 rounded-full h-2 mb-3">
                            <div class="bg-orange-500 h-2 rounded-full" style="width: ${t.utilization}%"></div>
                        </div>
                        <p class="text-sm">ğŸ“Œ ${t.current_task}</p>
                    </div>
                `).join('');

                document.getElementById('teams-container').innerHTML = html;
            } catch (e) {}
        }

        loadTeams();
    </script>
</body>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ‘¥ íŒ€ ê´€ë¦¬ â€” JARVIS</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .skill-item {
            background: #f9fafb;
            border-left: 4px solid #3b82f6;
            padding: 12px;
            margin: 8px 0;
            border-radius: 4px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .skill-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        .skill-active { background: #dcfce7; color: #166534; }
        .skill-progress { background: #fef3c7; color: #92400e; }
        .skill-blocked { background: #fee2e2; color: #991b1b; }
        .progress-bar {
            background: linear-gradient(90deg, #f97316, #fb923c);
            border-radius: 4px;
            height: 8px;
            overflow: hidden;
        }
        .team-card {
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .team-card:hover {
            border-color: #f97316;
            box-shadow: 0 4px 12px rgba(249, 115, 22, 0.2);
        }
        .team-card.selected {
            border-color: #f97316;
            background: linear-gradient(135deg, #fffbeb, #fef3c7);
        }
    </style>
</head>
<body class="bg-gray-50">
    <div class="min-h-screen">
        <!-- Header -->
        <div class="bg-white border-b border-gray-200 sticky top-0 z-50">
            <div class="max-w-7xl mx-auto px-4 py-4 sm:px-6 lg:px-8">
                <div class="flex justify-between items-center">
                    <div>
                        <h1 class="text-2xl font-bold text-gray-900">ğŸ‘¥ íŒ€ ê´€ë¦¬</h1>
                        <p class="text-sm text-gray-600">JARVIS íŒ€ ìŠ¤í‚¬ ê´€ë¦¬ ì„¼í„°</p>
                    </div>
                    <a href="operations.html" class="text-orange-600 hover:text-orange-700 font-semibold">â† ëŒì•„ê°€ê¸°</a>
                </div>
            </div>
        </div>

        <div class="max-w-7xl mx-auto px-4 py-6 sm:px-6 lg:px-8">
            <!-- ì „ì²´ íŒ€ ìš”ì•½ -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                <div class="bg-white rounded-lg shadow p-4">
                    <p class="text-sm text-gray-600">ğŸ“Š ì „ì²´ ìŠ¤í‚¬ ì™„ì„±ë„</p>
                    <p class="text-3xl font-bold text-orange-600 mt-2">40%</p>
                    <p class="text-xs text-gray-500 mt-2">29/70 skills active</p>
                </div>
                <div class="bg-white rounded-lg shadow p-4">
                    <p class="text-sm text-gray-600">âœ… í™œì„± íŒ€</p>
                    <p class="text-3xl font-bold text-green-600 mt-2">7/10</p>
                    <p class="text-xs text-gray-500 mt-2">50%+ skill level</p>
                </div>
                <div class="bg-white rounded-lg shadow p-4">
                    <p class="text-sm text-gray-600">â³ ì—…ê·¸ë ˆì´ë“œ ëŒ€ê¸°</p>
                    <p class="text-3xl font-bold text-yellow-600 mt-2">3/10</p>
                    <p class="text-xs text-gray-500 mt-2">Needs attention</p>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- íŒ€ ë¦¬ìŠ¤íŠ¸ -->
                <div class="lg:col-span-2">
                    <div class="bg-white rounded-lg shadow p-6">
                        <h2 class="text-lg font-bold mb-4">ğŸ¢ 10ê°œ íŒ€</h2>
                        <div id="teams-grid" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <!-- íŒ€ ì¹´ë“œë“¤ì´ ì—¬ê¸° ìƒì„±ë¨ -->
                        </div>
                    </div>
                </div>

                <!-- íŒ€ ìƒì„¸ ì •ë³´ -->
                <div class="bg-white rounded-lg shadow p-6" id="team-detail" style="display: none;">
                    <h2 id="team-name" class="text-lg font-bold mb-4">íŒ€ ì„ íƒ</h2>

                    <div class="mb-4">
                        <p class="text-sm text-gray-600 mb-2">ìŠ¤í‚¬ ì™„ì„±ë„</p>
                        <div class="text-2xl font-bold text-orange-600" id="team-percent">0%</div>
                        <div class="progress-bar mt-2" style="width: 100%;">
                            <div id="team-progress-fill" style="width: 0%; height: 100%; background: linear-gradient(90deg, #16a34a, #22c55e);"></div>
                        </div>
                    </div>

                    <div class="mb-6 p-3 bg-blue-50 rounded">
                        <p class="text-sm text-blue-900" id="team-description">íŒ€ ì„¤ëª…</p>
                    </div>

                    <h3 class="font-semibold text-gray-900 mb-3">ìŠ¤í‚¬ ìƒíƒœ</h3>
                    <div id="team-skills" class="space-y-2 mb-6" style="max-height: 300px; overflow-y: auto;">
                        <!-- ìŠ¤í‚¬ë“¤ì´ ì—¬ê¸° ìƒì„±ë¨ -->
                    </div>

                    <button
                        id="upgrade-btn"
                        onclick="upgradeTeam()"
                        class="w-full bg-orange-500 text-white py-2 rounded-lg font-semibold hover:bg-orange-600 transition"
                    >
                        ğŸ”§ íŒ€ ì—…ê·¸ë ˆì´ë“œ
                    </button>
                </div>
            </div>

            <!-- íŒ€ë³„ ì„±ê³¼ -->
            <div class="bg-white rounded-lg shadow p-6 mt-6">
                <h2 class="text-lg font-bold mb-4">ğŸ“Š íŒ€ë³„ ì„±ê³¼</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4">
                    <div class="p-4 bg-gradient-to-br from-orange-50 to-orange-100 rounded">
                        <p class="text-sm text-gray-700">ğŸ§­ Team 01</p>
                        <p class="text-2xl font-bold text-orange-600">60%</p>
                        <p class="text-xs text-gray-600 mt-1">3/5 skills</p>
                    </div>
                    <div class="p-4 bg-gradient-to-br from-blue-50 to-blue-100 rounded">
                        <p class="text-sm text-gray-700">ğŸ“‹ Team 02</p>
                        <p class="text-2xl font-bold text-blue-600">50%</p>
                        <p class="text-xs text-gray-600 mt-1">3/6 skills</p>
                    </div>
                    <div class="p-4 bg-gradient-to-br from-purple-50 to-purple-100 rounded">
                        <p class="text-sm text-gray-700">âš™ï¸ Team 05</p>
                        <p class="text-2xl font-bold text-purple-600">37%</p>
                        <p class="text-xs text-gray-600 mt-1">3/8 skills</p>
                    </div>
                    <div class="p-4 bg-gradient-to-br from-pink-50 to-pink-100 rounded">
                        <p class="text-sm text-gray-700">ğŸ¨ Team 06</p>
                        <p class="text-2xl font-bold text-pink-600">28%</p>
                        <p class="text-xs text-gray-600 mt-1">2/7 skills</p>
                    </div>
                    <div class="p-4 bg-gradient-to-br from-red-50 to-red-100 rounded">
                        <p class="text-sm text-gray-700">ğŸš€ Team 09</p>
                        <p class="text-2xl font-bold text-red-600">14%</p>
                        <p class="text-xs text-gray-600 mt-1">1/7 skills</p>
                    </div>
                </div>
            </div>

            <!-- ì—…ê·¸ë ˆì´ë“œ ë¡œê·¸ -->
            <div class="bg-white rounded-lg shadow p-6 mt-6">
                <h2 class="text-lg font-bold mb-4">ğŸ“ ìµœê·¼ ì—…ê·¸ë ˆì´ë“œ</h2>
                <div class="space-y-2 text-sm text-gray-700 font-mono">
                    <p>âœ… 2026-02-23 09:45 â€” Team 05: Redis Caching ì™„ë£Œ</p>
                    <p>âœ… 2026-02-23 08:20 â€” Team 06: Responsive Design ì§„í–‰ ì¤‘ (75%)</p>
                    <p>â³ 2026-02-22 18:15 â€” Team 09: Kubernetes ì„¤ì¹˜ ì¤‘ (50%)</p>
                    <p>âŒ 2026-02-22 14:30 â€” Team 07: Performance Testing (Blocked)</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        const API_BASE = "http://localhost:5000/api/v1";
        let selectedTeam = null;

        const TEAM_SKILLS = {
            "01": {
                "name": "ğŸ§­ Team 01: Chief Dispatcher",
                "description": "í”„ë¡œì íŠ¸ ìš°ì„ ìˆœìœ„ ì§€ì • ë° íŒ€ ì¡°ìœ¨",
                "icon": "ğŸ§­",
                "skills": [
                    { name: "WSJF Prioritization", status: "active", percent: 100 },
                    { name: "Conflict Resolution", status: "active", percent: 100 },
                    { name: "Pipeline Orchestration", status: "active", percent: 100 },
                    { name: "Risk Assessment", status: "progress", percent: 45 },
                    { name: "Team Sync", status: "blocked", percent: 0 },
                ]
            },
            "05": {
                "name": "âš™ï¸ Team 05: Backend Developer",
                "description": "API ê°œë°œ ë° ë°ì´í„°ë² ì´ìŠ¤ êµ¬í˜„",
                "icon": "âš™ï¸",
                "skills": [
                    { name: "TDD", status: "active", percent: 100 },
                    { name: "Clean Architecture", status: "active", percent: 100 },
                    { name: "API Development", status: "active", percent: 100 },
                    { name: "Database Implementation", status: "progress", percent: 35 },
                    { name: "Caching Strategy", status: "blocked", percent: 0 },
                    { name: "Message Queues", status: "blocked", percent: 0 },
                    { name: "Authentication", status: "blocked", percent: 0 },
                    { name: "Performance Tuning", status: "blocked", percent: 0 },
                ]
            },
            "06": {
                "name": "ğŸ¨ Team 06: Frontend Developer",
                "description": "UI/UX ê°œë°œ ë° ë°˜ì‘í˜• ë””ìì¸",
                "icon": "ğŸ¨",
                "skills": [
                    { name: "Atomic Design", status: "active", percent: 100 },
                    { name: "WCAG 2.1", status: "active", percent: 100 },
                    { name: "BDD Testing", status: "progress", percent: 30 },
                    { name: "React/Next.js", status: "progress", percent: 60 },
                    { name: "UX Research", status: "blocked", percent: 0 },
                    { name: "Performance Optimization", status: "blocked", percent: 0 },
                    { name: "Responsive Design", status: "blocked", percent: 0 },
                ]
            },
            "09": {
                "name": "ğŸš€ Team 09: DevOps Engineer",
                "description": "ì¸í”„ë¼ ê´€ë¦¬ ë° ë°°í¬ ìë™í™”",
                "icon": "ğŸš€",
                "skills": [
                    { name: "SLO/SLI", status: "active", percent: 100 },
                    { name: "GitOps", status: "progress", percent: 55 },
                    { name: "Blue-Green Deployment", status: "progress", percent: 60 },
                    { name: "Container Orchestration", status: "blocked", percent: 0 },
                    { name: "Monitoring & Alerting", status: "blocked", percent: 0 },
                    { name: "Database Replication", status: "blocked", percent: 0 },
                    { name: "Disaster Recovery", status: "blocked", percent: 0 },
                ]
            },
        };

        async function apiCall(endpoint, method = "GET", data = null) {
            try {
                const options = {
                    method: method,
                    headers: { "Content-Type": "application/json" },
                };
                if (data) options.body = JSON.stringify(data);

                const response = await fetch(API_BASE + endpoint, options);
                return await response.json();
            } catch (error) {
                console.error("API Error:", error);
                return null;
            }
        }

        async function loadTeams() {
            const result = await apiCall("/teams");
            if (!result || !result.teams) return;

            const grid = document.getElementById("teams-grid");
            grid.innerHTML = "";

            result.teams.forEach(team => {
                const card = document.createElement("div");
                card.className = "team-card";
                card.innerHTML = `
                    <div class="flex justify-between items-start mb-2">
                        <div>
                            <p class="font-semibold text-gray-900">${team.name}</p>
                        </div>
                        <span class="text-2xl">${TEAM_SKILLS[team.id]?.icon || "ğŸ¢"}</span>
                    </div>
                    <div class="mt-3">
                        <div class="text-sm font-semibold text-orange-600">${team.skill_percent}%</div>
                        <div class="progress-bar mt-1" style="width: 100%;">
                            <div style="width: ${team.skill_percent}%; height: 100%; background: linear-gradient(90deg, #f97316, #fb923c);"></div>
                        </div>
                    </div>
                    <p class="text-xs text-gray-500 mt-2">${team.skills}</p>
                `;
                card.onclick = () => selectTeam(team.id);
                grid.appendChild(card);
            });
        }

        function selectTeam(teamId) {
            selectedTeam = teamId;
            const teamData = TEAM_SKILLS[teamId];

            if (!teamData) return;

            // UI ì—…ë°ì´íŠ¸
            document.getElementById("team-name").textContent = teamData.name;
            document.getElementById("team-description").textContent = teamData.description;
            document.getElementById("team-percent").textContent = Math.round(teamData.skills.filter(s => s.status === "active").length / teamData.skills.length * 100) + "%";
            document.getElementById("team-progress-fill").style.width = Math.round(teamData.skills.filter(s => s.status === "active").length / teamData.skills.length * 100) + "%";

            // ìŠ¤í‚¬ ë¦¬ìŠ¤íŠ¸
            const skillsList = document.getElementById("team-skills");
            skillsList.innerHTML = "";
            teamData.skills.forEach(skill => {
                const badgeClass = skill.status === "active" ? "skill-active" : skill.status === "progress" ? "skill-progress" : "skill-blocked";
                const statusText = skill.status === "active" ? "âœ… Active" : skill.status === "progress" ? "â³ Progress" : "âŒ Blocked";

                const item = document.createElement("div");
                item.className = "skill-item";
                item.innerHTML = `
                    <span>${skill.name}</span>
                    <div class="flex items-center gap-2">
                        <span class="skill-badge ${badgeClass}">${statusText}</span>
                        <span class="text-xs text-gray-600">${skill.percent}%</span>
                    </div>
                `;
                skillsList.appendChild(item);
            });

            document.getElementById("team-detail").style.display = "block";

            // íŒ€ ì¹´ë“œ ì„ íƒ ìƒíƒœ ì—…ë°ì´íŠ¸
            document.querySelectorAll(".team-card").forEach((card, idx) => {
                card.classList.remove("selected");
            });
            event.currentTarget.classList.add("selected");
        }

        async function upgradeTeam() {
            if (!selectedTeam) return;
            const result = await apiCall(`/teams/${selectedTeam}/upgrade`, "POST");
            if (result) {
                alert(`ğŸ”§ ì—…ê·¸ë ˆì´ë“œ ì‹œì‘\n\n${result.team_name}\n${result.skills_to_install}ê°œ ìŠ¤í‚¬ ì„¤ì¹˜\nì˜ˆìƒ: ${result.estimated_time}`);
            }
        }

        // ì´ˆê¸°í™”
        loadTeams();
    </script>
</body>
</html>
