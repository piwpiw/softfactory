<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Operations - JARVIS</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-900 text-white">
    <nav class="bg-gray-800 border-b border-gray-700 px-6 py-4 flex justify-between items-center">
        <h1 class="text-2xl font-bold">Operations Control</h1>
        <a href="index.html" class="text-gray-400 hover:text-white">← 홈</a>
    </nav>

    <main class="p-6 max-w-6xl mx-auto">
        <!-- Deploy Section -->
        <div class="mb-8">
            <h2 class="text-2xl font-bold mb-4">배포</h2>
            <div class="bg-gray-800 p-6 rounded-lg">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <select id="deploy-env" class="bg-gray-700 p-3 rounded border border-gray-600">
                        <option value="prod">Production</option>
                        <option value="staging">Staging</option>
                    </select>
                    <input id="deploy-version" type="text" placeholder="v1.2.25" class="bg-gray-700 p-3 rounded border border-gray-600">
                    <button onclick="deploy()" class="bg-orange-600 hover:bg-orange-700 p-3 rounded font-bold">배포 시작</button>
                </div>
                <div id="deploy-progress" class="mt-4 hidden">
                    <div class="text-sm mb-2">진행: <span id="deploy-status">0%</span></div>
                    <div class="bg-gray-700 rounded-full h-4 overflow-hidden">
                        <div id="deploy-bar" class="bg-orange-500 h-full" style="width: 0%; transition: width 0.3s;"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Mission Section -->
        <div class="mb-8">
            <h2 class="text-2xl font-bold mb-4">미션</h2>
            <div class="bg-gray-800 p-6 rounded-lg">
                <div class="flex gap-4 mb-4">
                    <input id="mission-name" type="text" placeholder="미션 이름" class="flex-1 bg-gray-700 p-3 rounded border border-gray-600">
                    <button onclick="createMission()" class="bg-blue-600 hover:bg-blue-700 px-6 py-3 rounded font-bold">생성</button>
                </div>
                <div id="missions-list" class="space-y-2"></div>
            </div>
        </div>

        <!-- Active Teams -->
        <div>
            <h2 class="text-2xl font-bold mb-4">활성 팀</h2>
            <div id="teams-grid" class="grid grid-cols-1 md:grid-cols-3 gap-4"></div>
        </div>
    </main>

    <script>
        async function deploy() {
            document.getElementById('deploy-progress').classList.remove('hidden');
            for (let i = 0; i <= 100; i += 20) {
                document.getElementById('deploy-bar').style.width = i + '%';
                document.getElementById('deploy-status').textContent = i + '%';
                await new Promise(r => setTimeout(r, 300));
            }
            alert('배포 완료!');
        }

        async function createMission() {
            const name = document.getElementById('mission-name').value;
            if (!name) return alert('미션 이름을 입력하세요');

            const list = document.getElementById('missions-list');
            list.innerHTML += `<div class="bg-gray-700 p-3 rounded">✅ ${name}</div>`;
            document.getElementById('mission-name').value = '';
        }

        async function loadTeams() {
            try {
                const res = await fetch('/api/v1/teams');
                const data = await res.json();
                const grid = document.getElementById('teams-grid');
                grid.innerHTML = data.teams.slice(0, 3).map(t => `
                    <div class="bg-gray-800 p-4 rounded">
                        <h3 class="font-bold">${t.name}</h3>
                        <p class="text-sm text-gray-400">${t.members}명 - ${t.utilization}% 활용</p>
                        <p class="text-sm mt-2">${t.current_task}</p>
                    </div>
                `).join('');
            } catch (e) {}
        }
        loadTeams();
    </script>
</body>
</html>
