<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì„¤ì • â€” SNS Auto | SoftFactory</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="../platform/api.js"></script>
    <style>body { font-family: 'Inter', sans-serif; }</style>
</head>
<body class="bg-slate-950 text-slate-100">
    <div class="flex h-screen overflow-hidden">
        <aside class="w-64 bg-slate-900 border-r border-slate-800 flex flex-col shrink-0">
            <div class="p-6"><a href="index.html" class="flex items-center gap-3"><span class="text-2xl">ğŸ“±</span><h1 class="font-bold text-white text-sm">SNS Auto</h1></a></div>
            <nav class="flex-1 p-6 space-y-2">
                <a href="index.html" class="flex items-center gap-3 px-4 py-2.5 rounded-lg text-slate-300 hover:bg-slate-800">ğŸ“Š ëŒ€ì‹œ</a>
                <a href="settings.html" class="flex items-center gap-3 px-4 py-2.5 rounded-lg bg-pink-600 text-white font-medium">âš™ï¸ ì„¤ì •</a>
            </nav>
        </aside>
        <div class="flex-1 flex flex-col overflow-hidden">
            <header class="h-16 bg-slate-900 border-b border-slate-800 px-6 flex items-center"><h2 class="text-xl font-bold text-white">âš™ï¸ SNS Auto ì„¤ì •</h2></header>
            <main class="flex-1 overflow-y-auto p-6">
                <div class="max-w-2xl space-y-6">
                    <form id="settingsForm" class="space-y-6">
                        <div class="bg-slate-800 rounded-xl p-8 border border-slate-700">
                            <h3 class="text-xl font-bold text-white mb-6">ë°œí–‰ ì„¤ì •</h3>
                            <div class="space-y-4">
                                <label class="flex items-center gap-3">
                                    <input type="checkbox" name="auto_optimal_time" class="w-4 h-4 rounded">
                                    <span class="text-white">ìë™ ìµœì  ì‹œê°„ ë°œí–‰</span>
                                </label>
                                <label class="flex items-center gap-3">
                                    <input type="checkbox" name="engagement_notifications" class="w-4 h-4 rounded">
                                    <span class="text-white">ì—”ê²Œì´ì§€ë¨¼íŠ¸ ì•Œë¦¼</span>
                                </label>
                                <label class="flex items-center gap-3">
                                    <input type="checkbox" name="auto_reply_enabled" class="w-4 h-4 rounded">
                                    <span class="text-white">ëŒ“ê¸€ ìë™ ì‘ë‹µ</span>
                                </label>
                            </div>
                        </div>

                        <div class="bg-slate-800 rounded-xl p-8 border border-slate-700">
                            <h3 class="text-xl font-bold text-white mb-6">ì½˜í…ì¸  í•„í„°</h3>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-slate-300 mb-2">ê¸ˆì§€ í‚¤ì›Œë“œ (ì‰¼í‘œë¡œ êµ¬ë¶„)</label>
                                    <input type="text" name="banned_keywords" placeholder="ê´‘ê³ , ìŠ¤íŒ¸, ..." class="w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-2.5 text-white placeholder-slate-500 focus:border-pink-500 focus:outline-none">
                                </div>
                            </div>
                        </div>

                        <button type="submit" class="w-full px-4 py-3 bg-pink-600 hover:bg-pink-700 text-white rounded-lg font-medium transition">ì €ì¥í•˜ê¸°</button>
                    </form>
                </div>
            </main>
        </div>
    </div>
    <script>
        requireAuth();

        async function init() {
            try {
                const result = await apiFetch('/api/sns/settings').then(r => r.json());
                const settings = result.settings || {};

                // Load settings into form
                if (settings.auto_optimal_time) document.querySelector('[name="auto_optimal_time"]').checked = true;
                if (settings.engagement_notifications) document.querySelector('[name="engagement_notifications"]').checked = true;
                if (settings.auto_reply_enabled) document.querySelector('[name="auto_reply_enabled"]').checked = true;
                if (settings.banned_keywords) document.querySelector('[name="banned_keywords"]').value = settings.banned_keywords.join(', ');
            } catch (error) {
                console.log('Settings load skipped (API not ready)');
            }
        }

        document.getElementById('settingsForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            try {
                const formData = new FormData(e.target);
                const payload = {
                    auto_optimal_time: formData.get('auto_optimal_time') === 'on',
                    engagement_notifications: formData.get('engagement_notifications') === 'on',
                    auto_reply_enabled: formData.get('auto_reply_enabled') === 'on',
                    banned_keywords: formData.get('banned_keywords').split(',').map(k => k.trim()).filter(k => k)
                };

                const result = await apiFetch('/api/sns/settings', {
                    method: 'PUT',
                    body: JSON.stringify(payload)
                }).then(r => r.json());

                showSuccess('ì„¤ì •ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
            } catch (error) {
                showError('ì„¤ì • ì €ì¥ ì‹¤íŒ¨: ' + error.message);
            }
        });

        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
